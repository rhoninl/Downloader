USB Camera HTTP Driver (C++)\n\nThis driver connects to a USB Video Class (UVC) webcam using the native V4L2 protocol on Linux and serves the live video over HTTP as an MJPEG stream.\n\nEndpoints\n- POST /connect: Initialize and attach the USB camera so its video can be served. Call this once after plugging in the camera.\n- GET /stream: Retrieve the live video stream from the connected USB camera. Returns multipart MJPEG; keep the HTTP connection open to watch.\n\nEnvironment Variables (required)\n- HTTP_HOST: Interface to bind the HTTP server (e.g., 0.0.0.0).\n- HTTP_PORT: Port for the HTTP server (e.g., 8080).\n- UVC_DEVICE: Video device path (e.g., /dev/video0).\n- UVC_WIDTH: Capture width (e.g., 640).\n- UVC_HEIGHT: Capture height (e.g., 480).\n- UVC_FPS: Capture frame rate (e.g., 30).\n- READ_TIMEOUT_MS: Read timeout for frame capture select() in milliseconds (e.g., 1000).\n- RETRY_BASE_MS: Initial retry/backoff delay in milliseconds (e.g., 500).\n- RETRY_MAX_MS: Maximum retry/backoff delay in milliseconds (e.g., 10000).\n- STREAM_BOUNDARY: Multipart MJPEG boundary label (e.g., frame).\n- LOG_LEVEL: One of TRACE, DEBUG, INFO, WARN, ERROR.\n\nBuild\n- Requires Linux with V4L2 headers (linux/videodev2.h).\n- Compile: g++ -std=c++17 driver.cpp -o driver\n\nRun\n1) Export required environment variables, e.g.:\n   export HTTP_HOST=0.0.0.0\n   export HTTP_PORT=8080\n   export UVC_DEVICE=/dev/video0\n   export UVC_WIDTH=640\n   export UVC_HEIGHT=480\n   export UVC_FPS=30\n   export READ_TIMEOUT_MS=1000\n   export RETRY_BASE_MS=500\n   export RETRY_MAX_MS=10000\n   export STREAM_BOUNDARY=frame\n   export LOG_LEVEL=INFO\n\n2) Start the driver:\n   ./driver\n\nUsage\n- Initialize camera:\n  curl -X POST http://localhost:8080/connect\n\n- Watch stream (MJPEG):\n  curl http://localhost:8080/stream\n\nNotes\n- This driver requires the camera to support MJPEG output. If MJPEG is not supported, the driver will log an error and retry with backoff.\n- The driver implements a background collection loop with timeout, retry and exponential backoff, maintains a thread-safe latest-frame buffer, and supports graceful shutdown.\n\nGenerated by [IoT Driver Copilot](https://copilot.test.shifu.dev/)\n