USB Camera HTTP Driver (C++)

Overview
- This driver connects to a USB Video Class (UVC) webcam via V4L2 (Linux) and exposes an HTTP interface.
- It captures MJPEG frames from the camera and serves them as an MJPEG-over-HTTP stream.
- Required endpoints:
  - POST /connect: Initialize and attach the camera.
  - GET /stream: Retrieve the live MJPEG stream.

Requirements
- Linux with V4L2 and a UVC-compliant camera (commonly available as /dev/video0).
- A C++17 compiler (e.g., g++) and pthread support.

Build
- Compile:
  g++ -std=c++17 -O2 -pthread driver.cpp -o driver

Configuration (environment variables)
- HTTP_HOST: Host to bind the HTTP server (default: 0.0.0.0)
- HTTP_PORT: Port to bind the HTTP server (default: 8080)
- CAMERA_DEVICE: V4L2 device path (default: /dev/video0)
- CAMERA_WIDTH: Requested width (default: 640)
- CAMERA_HEIGHT: Requested height (default: 480)
- CAMERA_FPS: Requested frames per second (default: 30)
- CAPTURE_TIMEOUT_MS: Timeout for frame capture select() in ms (default: 1000)
- RETRY_MAX_ATTEMPTS: Max reconnect attempts; 0 = infinite (default: 0)
- BACKOFF_INITIAL_MS: Initial backoff delay for reconnect in ms (default: 500)
- BACKOFF_MAX_MS: Max backoff delay in ms (default: 5000)

Run
- Set any desired environment variables, then run:
  HTTP_PORT=8080 CAMERA_DEVICE=/dev/video0 ./driver

API Usage
- Initialize camera:
  curl -X POST http://localhost:8080/connect
- Stream video (open in browser or via curl):
  curl -N http://localhost:8080/stream

Notes
- This driver requires the webcam to support MJPEG (most UVC cameras do). If MJPEG is not supported, /connect will continue retrying and logs will indicate the pixel format mismatch.
- Background collection includes timeout handling, retries, and exponential backoff. Logs show connect/disconnect events, retries, errors, and frame update timestamps.
- Graceful shutdown: Press Ctrl+C (SIGINT) or send SIGTERM; the server and capture thread will stop cleanly.

Generated by [IoT Driver Copilot](https://copilot.test.shifu.dev/)